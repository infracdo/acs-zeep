{"remainingRequest":"/home/ubuntu/acs/node_modules/thread-loader/dist/cjs.js!/home/ubuntu/acs/node_modules/babel-loader/lib/index.js!/home/ubuntu/acs/node_modules/eslint-loader/index.js??ref--14-0!/home/ubuntu/acs/src/store/modules/permission.js","dependencies":[{"path":"/home/ubuntu/acs/src/store/modules/permission.js","mtime":1747185179308},{"path":"/home/ubuntu/acs/babel.config.js","mtime":1747185378775},{"path":"/home/ubuntu/acs/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/home/ubuntu/acs/node_modules/thread-loader/dist/cjs.js","mtime":499162500000},{"path":"/home/ubuntu/acs/node_modules/babel-loader/lib/index.js","mtime":456789000000},{"path":"/home/ubuntu/acs/node_modules/eslint-loader/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0IF9yZWdlbmVyYXRvclJ1bnRpbWUgZnJvbSAiL2hvbWUvdWJ1bnR1L2Fjcy9ub2RlX21vZHVsZXMvQGJhYmVsL3J1bnRpbWUvaGVscGVycy9lc20vcmVnZW5lcmF0b3JSdW50aW1lLmpzIjsKaW1wb3J0IF9hc3luY1RvR2VuZXJhdG9yIGZyb20gIi9ob21lL3VidW50dS9hY3Mvbm9kZV9tb2R1bGVzL0BiYWJlbC9ydW50aW1lL2hlbHBlcnMvZXNtL2FzeW5jVG9HZW5lcmF0b3IuanMiOwppbXBvcnQgX29iamVjdFNwcmVhZCBmcm9tICIvaG9tZS91YnVudHUvYWNzL25vZGVfbW9kdWxlcy9AYmFiZWwvcnVudGltZS9oZWxwZXJzL2VzbS9vYmplY3RTcHJlYWQyLmpzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuYXJyYXkuY29uY2F0LmpzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuYXJyYXkuaW5jbHVkZXMuanMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5hcnJheS5wdXNoLmpzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuaXRlcmF0b3IuY29uc3RydWN0b3IuanMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5pdGVyYXRvci5mb3ItZWFjaC5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLml0ZXJhdG9yLnNvbWUuanMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5vYmplY3QudG8tc3RyaW5nLmpzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuc3RyaW5nLmluY2x1ZGVzLmpzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvd2ViLmRvbS1jb2xsZWN0aW9ucy5mb3ItZWFjaC5qcyI7CmltcG9ydCByb3V0ZXIsIHsgYXN5bmNSb3V0ZXMsIGNvbnN0YW50Um91dGVzIH0gZnJvbSAnQC9yb3V0ZXInOwoKLyoqCiAqIFRocm91Z2ggbWV0YS5yb2xlIGRldGVybWluZXMgd2hldGhlciB0aGUgY3VycmVudCB1c2VyIHJpZ2h0cyBtYXRjaAogKiBAcGFyYW0gcm9sZXMKICogQHBhcmFtIHJvdXRlCiAqLwp2YXIgaGFzUGVybWlzc2lvbiA9IGZ1bmN0aW9uIGhhc1Blcm1pc3Npb24ocm9sZXMsIHJvdXRlKSB7CiAgaWYgKHJvdXRlLm1ldGEgJiYgcm91dGUubWV0YS5yb2xlcykgewogICAgcmV0dXJuIHJvbGVzLnNvbWUoZnVuY3Rpb24gKHJvbGUpIHsKICAgICAgcmV0dXJuIHJvdXRlLm1ldGEucm9sZXMuaW5jbHVkZXMocm9sZSk7CiAgICB9KTsKICB9CiAgcmV0dXJuIHRydWU7Cn07CgovKioKICogUmVjdXJzaXZlbHkgZmlsdGVyIGFzeW5jaHJvbm91cyByb3V0aW5nIHRhYmxlcyB0byByZXR1cm4gcm91dGluZyB0YWJsZXMKICogdGhhdCBtZWV0IHVzZXIgcm9sZSBwZXJtaXNzaW9ucwogKiBAcGFyYW0gcm9sZXMKICogQHBhcmFtIHJvdXRlcyBhc3luY1JvdXRlcwogKi8KdmFyIF9maWx0ZXJBc3luY1JvdXRlcyA9IGZ1bmN0aW9uIGZpbHRlckFzeW5jUm91dGVzKHJvbGVzLCByb3V0ZXMpIHsKICB2YXIgcmVzID0gW107CiAgcm91dGVzLmZvckVhY2goZnVuY3Rpb24gKHJvdXRlKSB7CiAgICB2YXIgdG1wID0gX29iamVjdFNwcmVhZCh7fSwgcm91dGUpOwogICAgaWYgKGhhc1Blcm1pc3Npb24ocm9sZXMsIHRtcCkpIHsKICAgICAgaWYgKHRtcC5jaGlsZHJlbikgewogICAgICAgIHRtcC5jaGlsZHJlbiA9IF9maWx0ZXJBc3luY1JvdXRlcyhyb2xlcywgdG1wLmNoaWxkcmVuKTsKICAgICAgfQogICAgICByZXMucHVzaCh0bXApOwogICAgfQogIH0pOwogIHJldHVybiByZXM7Cn07CmV4cG9ydCB7IF9maWx0ZXJBc3luY1JvdXRlcyBhcyBmaWx0ZXJBc3luY1JvdXRlcyB9Owp2YXIgcGVybWlzc2lvbiA9IHsKICBzdGF0ZTogewogICAgcm91dGVzOiBbXSwKICAgIGFkZFJvdXRlczogW10KICB9LAogIGdldHRlcnM6IHsKICAgIHBlcm1pc3Npb25Sb3V0ZXM6IGZ1bmN0aW9uIHBlcm1pc3Npb25Sb3V0ZXMoc3RhdGUpIHsKICAgICAgcmV0dXJuIHN0YXRlLnJvdXRlczsKICAgIH0sCiAgICBhZGRSb3V0ZXM6IGZ1bmN0aW9uIGFkZFJvdXRlcyhzdGF0ZSkgewogICAgICByZXR1cm4gc3RhdGUuYWRkUm91dGVzOwogICAgfQogIH0sCiAgbXV0YXRpb25zOiB7CiAgICBTRVRfUk9VVEVTOiBmdW5jdGlvbiBTRVRfUk9VVEVTKHN0YXRlLCByb3V0ZXMpIHsKICAgICAgc3RhdGUuYWRkUm91dGVzID0gcm91dGVzOwogICAgICBzdGF0ZS5yb3V0ZXMgPSBjb25zdGFudFJvdXRlcy5jb25jYXQocm91dGVzKTsKICAgIH0KICB9LAogIGFjdGlvbnM6IHsKICAgIEdlbmVyYXRlUm91dGVzOiBmdW5jdGlvbiAoKSB7CiAgICAgIHZhciBfR2VuZXJhdGVSb3V0ZXMgPSBfYXN5bmNUb0dlbmVyYXRvcigvKiNfX1BVUkVfXyovX3JlZ2VuZXJhdG9yUnVudGltZSgpLm1hcmsoZnVuY3Rpb24gX2NhbGxlZShfcmVmLCBfcmVmMikgewogICAgICAgIHZhciBjb21taXQsIHJvbGVzLCBhY2Nlc3NlZFJvdXRlczsKICAgICAgICByZXR1cm4gX3JlZ2VuZXJhdG9yUnVudGltZSgpLndyYXAoZnVuY3Rpb24gX2NhbGxlZSQoX2NvbnRleHQpIHsKICAgICAgICAgIHdoaWxlICgxKSBzd2l0Y2ggKF9jb250ZXh0LnByZXYgPSBfY29udGV4dC5uZXh0KSB7CiAgICAgICAgICAgIGNhc2UgMDoKICAgICAgICAgICAgICBjb21taXQgPSBfcmVmLmNvbW1pdDsKICAgICAgICAgICAgICByb2xlcyA9IF9yZWYyLnJvbGVzOwogICAgICAgICAgICAgIHRyeSB7CiAgICAgICAgICAgICAgICBjb25zb2xlLmdyb3VwQ29sbGFwc2VkKCJbdnVleC5wZXJtaXNzaW9uXSBHZW5lcmF0ZVJvdXRlcyBbIi5jb25jYXQocm9sZXMsICJdIikpOwogICAgICAgICAgICAgICAgaWYgKHJvbGVzLmluY2x1ZGVzKCdhZG1pbicpKSB7CiAgICAgICAgICAgICAgICAgIGFjY2Vzc2VkUm91dGVzID0gYXN5bmNSb3V0ZXM7CiAgICAgICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgICBhY2Nlc3NlZFJvdXRlcyA9IF9maWx0ZXJBc3luY1JvdXRlcyhyb2xlcywgYXN5bmNSb3V0ZXMpOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgY29tbWl0KCdTRVRfUk9VVEVTJywgYWNjZXNzZWRSb3V0ZXMpOwogICAgICAgICAgICAgICAgLy8gQXBwbHkgc2VsZWN0ZWQgYWxsb3dlZCByb3V0ZXMKICAgICAgICAgICAgICAgIHJvdXRlci5hZGRSb3V0ZXMoYWNjZXNzZWRSb3V0ZXMpOwogICAgICAgICAgICAgICAgY29uc29sZS5sb2coJ1t2dWV4LnBlcm1pc3Npb25dIGFjY2Vzc2VkUm91dGVzICcsIGNvbnN0YW50Um91dGVzKTsKICAgICAgICAgICAgICAgIGNvbnNvbGUuZ3JvdXBFbmQoKTsKICAgICAgICAgICAgICB9IGNhdGNoIChlcnIpIHsKICAgICAgICAgICAgICAgIGNvbnNvbGUud2FybignW3Z1ZXgucGVybWlzc2lvbl0gR2VuZXJhdGVSb3V0ZXMnLCBlcnIpOwogICAgICAgICAgICAgIH0KICAgICAgICAgICAgY2FzZSAzOgogICAgICAgICAgICBjYXNlICJlbmQiOgogICAgICAgICAgICAgIHJldHVybiBfY29udGV4dC5zdG9wKCk7CiAgICAgICAgICB9CiAgICAgICAgfSwgX2NhbGxlZSk7CiAgICAgIH0pKTsKICAgICAgZnVuY3Rpb24gR2VuZXJhdGVSb3V0ZXMoX3gsIF94MikgewogICAgICAgIHJldHVybiBfR2VuZXJhdGVSb3V0ZXMuYXBwbHkodGhpcywgYXJndW1lbnRzKTsKICAgICAgfQogICAgICByZXR1cm4gR2VuZXJhdGVSb3V0ZXM7CiAgICB9KCkKICB9Cn07CmV4cG9ydCBkZWZhdWx0IHBlcm1pc3Npb247"},{"version":3,"names":["router","asyncRoutes","constantRoutes","hasPermission","roles","route","meta","some","role","includes","filterAsyncRoutes","routes","res","forEach","tmp","_objectSpread","children","push","_filterAsyncRoutes","permission","state","addRoutes","getters","permissionRoutes","mutations","SET_ROUTES","concat","actions","GenerateRoutes","_GenerateRoutes","_asyncToGenerator","_regeneratorRuntime","mark","_callee","_ref","_ref2","commit","accessedRoutes","wrap","_callee$","_context","prev","next","console","groupCollapsed","log","groupEnd","err","warn","stop","_x","_x2","apply","arguments"],"sources":["/home/ubuntu/acs/src/store/modules/permission.js"],"sourcesContent":["import router, { asyncRoutes, constantRoutes } from '@/router';\n\n/**\n * Through meta.role determines whether the current user rights match\n * @param roles\n * @param route\n */\nconst hasPermission = (roles, route) => {\n  if (route.meta && route.meta.roles) {\n    return roles.some((role) => route.meta.roles.includes(role));\n  }\n  return true;\n};\n\n/**\n * Recursively filter asynchronous routing tables to return routing tables\n * that meet user role permissions\n * @param roles\n * @param routes asyncRoutes\n */\nexport const filterAsyncRoutes = (roles, routes) => {\n  const res = [];\n  routes.forEach((route) => {\n    const tmp = { ...route };\n    if (hasPermission(roles, tmp)) {\n      if (tmp.children) {\n        tmp.children = filterAsyncRoutes(roles, tmp.children);\n      }\n      res.push(tmp);\n    }\n  });\n  return res;\n};\n\nconst permission = {\n  state: {\n    routes: [],\n    addRoutes: [],\n  },\n\n  getters: {\n    permissionRoutes: (state) => state.routes,\n    addRoutes: (state) => state.addRoutes,\n  },\n\n  mutations: {\n    SET_ROUTES: (state, routes) => {\n      state.addRoutes = routes;\n      state.routes = constantRoutes.concat(routes);\n    },\n  },\n  actions: {\n    GenerateRoutes: async ({ commit }, { roles }) => {\n      try {\n        console.groupCollapsed(`[vuex.permission] GenerateRoutes [${roles}]`);\n        let accessedRoutes;\n        if (roles.includes('admin')) {\n          accessedRoutes = asyncRoutes;\n        } else {\n          accessedRoutes = filterAsyncRoutes(roles, asyncRoutes);\n        }\n        commit('SET_ROUTES', accessedRoutes);\n        // Apply selected allowed routes\n        router.addRoutes(accessedRoutes);\n        console.log('[vuex.permission] accessedRoutes ', constantRoutes);\n        console.groupEnd();\n      } catch (err) {\n        console.warn('[vuex.permission] GenerateRoutes', err);\n      }\n    },\n  },\n};\n\nexport default permission;\n"],"mappings":"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","ignoreList":[]}]}