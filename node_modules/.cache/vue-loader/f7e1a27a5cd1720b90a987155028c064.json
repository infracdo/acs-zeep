{"remainingRequest":"/home/ubuntu/acs/node_modules/vue-loader/lib/index.js??vue-loader-options!/home/ubuntu/acs/src/views/components/Monitoring.vue?vue&type=style&index=0&id=eba1b252&scoped=true&lang=css","dependencies":[{"path":"/home/ubuntu/acs/src/views/components/Monitoring.vue","mtime":1747193756136},{"path":"/home/ubuntu/acs/node_modules/@vue/cli-service/node_modules/css-loader/dist/cjs.js","mtime":499162500000},{"path":"/home/ubuntu/acs/node_modules/vue-loader/lib/loaders/stylePostLoader.js","mtime":499162500000},{"path":"/home/ubuntu/acs/node_modules/postcss-loader/src/index.js","mtime":499162500000},{"path":"/home/ubuntu/acs/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/home/ubuntu/acs/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ci8qIFByZXZlbnQgaGVhZGVyIHRleHQgd3JhcHBpbmcgYW5kIGNlbnRlciB2ZXJ0aWNhbGx5ICovCi5oZWFkZXItbm93cmFwID4+PiB0aCB7CiAgd2hpdGUtc3BhY2U6IG5vd3JhcDsKICB2ZXJ0aWNhbC1hbGlnbjogbWlkZGxlICFpbXBvcnRhbnQ7Cn0KCi8qIEVuc3VyZSB0YWJsZSBjZWxscyBkb24ndCB3cmFwIGVpdGhlciAqLwouaGVhZGVyLW5vd3JhcCA+Pj4gdGQgewogIHdoaXRlLXNwYWNlOiBub3dyYXA7Cn0KCi8qIE9wdGlvbmFsOiBBZGQgc29tZSBwYWRkaW5nIHRvIGhlYWRlcnMgZm9yIGJldHRlciBhcHBlYXJhbmNlICovCi5oZWFkZXItbm93cmFwID4+PiB0aCB7CiAgcGFkZGluZzogMCAxNnB4ICFpbXBvcnRhbnQ7Cn0K"},{"version":3,"sources":["Monitoring.vue"],"names":[],"mappings":";AAqaA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA","file":"Monitoring.vue","sourceRoot":"src/views/components","sourcesContent":["<template>\n  <v-container\n    fluid\n    class=\"pa-5\"\n  >\n    <!-- Overall Summary -->\n    <v-card class=\"pa-4 mb-6\">\n      <v-card-title class=\"pa-0\">\n        Overall Summary\n      </v-card-title>\n      <v-row>\n        <v-col\n          v-for=\"(card, index) in cardsOverallSummary\"\n          :key=\"index\"\n          cols=\"12\"\n          sm=\"6\"\n          md=\"4\"\n        >\n          <v-card\n            :style=\"{backgroundColor: card.color}\"\n          >\n            <v-card-title\n              class=\"font-weight-bold display-2 text-right\"\n              style=\"text-align: right; display: block; color: white;\"\n            >\n              {{ formatCardValue(card) }}\n              <!-- {{ card.value }} -->\n            </v-card-title>\n            <v-card-text\n              class=\"text-right text-subtitle-2\"\n              style=\"color: white;\"\n            >\n              {{ card.title }}\n            </v-card-text>\n          </v-card>\n        </v-col>\n      </v-row>\n    </v-card>\n\n    <!-- List of APs / Data per AP -->\n    <v-card class=\"pa-4 mb-6\">\n      <v-row\n        align=\"center\"\n        class=\"ma-0\"\n      >\n        <v-col class=\"pa-0\">\n          <v-card-title class=\"pa-0 mb-3\">\n            List of Access Points / Data Per Access Point\n          </v-card-title>\n        </v-col>\n        <v-col\n          class=\"pa-0\"\n          cols=\"auto\"\n        >\n          <v-select\n            v-model=\"selectedAccessPoint\"\n            flat\n            solo-inverted\n            hide-details\n            :items=\"accessPointOptions\"\n            item-text=\"text\"\n            item-value=\"value\"\n            style=\"width: 20em;\"\n            label=\"Select Access Point (AP)\"\n            @change=\"onAPChange\"\n          />\n        </v-col>\n      </v-row>\n      <v-col class=\"pa-0\">\n        <v-row>\n          <v-col\n            v-for=\"(card, index) in cardsAP\"\n            :key=\"index\"\n            cols=\"12\"\n            sm=\"6\"\n            md=\"4\"\n          >\n            <v-card\n              :style=\"{backgroundColor: card.color}\"\n            >\n              <v-card-title\n                class=\"font-weight-bold display-2 text-right\"\n                style=\"text-align: right; display: block; color: white;\"\n              >\n                {{ card.value }}\n              </v-card-title>\n              <v-card-text\n                class=\"text-right text-subtitle-2\"\n                style=\"color: white;\"\n              >\n                {{ card.title }}\n              </v-card-text>\n            </v-card>\n          </v-col>\n        </v-row>\n\n        <!-- Table for list of currently connected users per access point -->\n        <v-card class=\"mt-3\">\n          <v-card-title>\n            List of Currently Connected Users\n            <!-- <v-spacer />\n            <v-text-field\n              v-model=\"search\"\n              append-icon=\"mdi-magnify\"\n              label=\"Search\"\n              single-line\n              hide-details\n            /> -->\n          </v-card-title>\n          <div style=\"overflow-x: auto;\">\n            <v-data-table\n              dense\n              :headers=\"headers\"\n              :items=\"connectedUsers\"\n              item-key=\"macAddress\"\n              :loading=\"loading\"\n              loading-text=\"Loading... Please wait\"\n              style=\"min-width: 1000px\"\n              class=\"header-nowrap\"\n            >\n              <template v-slot:item.bandwidthMB=\"{ item }\">\n                {{ item.bandwidthMB }} MB\n              </template>\n            </v-data-table>\n          </div>\n        </v-card>\n      </v-col>\n    </v-card>\n\n    <!-- List of Connected Users -->\n    <!-- <v-card>\n      <v-card-title>\n        List of Connected Users\n      </v-card-title>\n      <v-data-table\n        dense\n        :headers=\"headersConnectedUsers\"\n        :items=\"listOfConnectedUsers\"\n        item-key=\"macAddress\"\n        :loading=\"loading\"\n        loading-text=\"Loading... Please wait\"\n      />\n    </v-card> -->\n  </v-container>\n</template>\n\n<script>\nimport ApiService from '../../api.service';\n\nexport default {\n  data() {\n    return {\n      cardsOverallSummary: [\n        {\n          title: 'Current Number of Connected Users',\n          value: 0,\n          color: '#66BB6A',\n          key: 'connectedUsers',\n        },\n        {\n          title: 'Current Number of Connected APs',\n          value: 0,\n          color: '#4DB6AC',\n          key: 'connectedAPs',\n        },\n        {\n          title: 'Total User Connections for Today',\n          value: 0,\n          color: '#FFB74D',\n          key: 'totalUserConnectionsToday',\n        },\n        {\n          title: 'Total Bandwidth Consumption for Today',\n          value: 0,\n          color: '#FDD835',\n          key: 'totalBandwidthConsumptionToday',\n        },\n        {\n          title: 'Average Connection Time',\n          value: 0,\n          color: '#1E88E5',\n          key: 'averageConnectionTime',\n        },\n        {\n          title: 'Average Bandwidth Per Connection',\n          value: 0,\n          color: '#E57373',\n          key: 'averageBandwidthPerConnection',\n        },\n      ],\n      cardsAP: [\n        {\n          title: 'Currently Connected Users',\n          value: 0,\n          color: '#66BB6A',\n          key: 'connectedUsersPerAP',\n        },\n        // {\n        //   title: 'Daily Average Connected Users',\n        //   value: 0,\n        //   color: '#4DB6AC',\n        // },\n        // {\n        //   title: 'Daily Average User Connection Time',\n        //   value: 0,\n        //   color: '#FFB74D',\n        // },\n        // {\n        //   title: 'Daily Average Bandwidth Consumption',\n        //   value: 0,\n        //   color: '#FDD835',\n        // },\n        // {\n        //   title: 'Daily Average Bandwidth Consumption Per User',\n        //   value: 0,\n        //   color: '#1E88E5',\n        // },\n      ],\n      headers: [\n        {\n          text: 'Account Number',\n          align: 'start',\n          sortable: true,\n          value: 'accountNumber',\n        },\n        {\n          text: 'Package',\n          align: 'start',\n          sortable: true,\n          value: 'package',\n        },\n        {\n          text: 'MAC Address',\n          align: 'start',\n          sortable: true,\n          value: 'macAddress',\n        },\n        {\n          text: 'Device',\n          align: 'start',\n          sortable: false,\n          value: 'device',\n        },\n        {\n          text: 'IP Address',\n          align: 'start',\n          sortable: true,\n          value: 'ipAddress',\n        },\n        {\n          text: 'SSID',\n          align: 'start',\n          sortable: true,\n          value: 'ssid',\n        },\n        {\n          text: 'Bandwidth Consumption',\n          align: 'start',\n          sortable: true,\n          value: 'bandwidthMB',\n        },\n        {\n          text: 'Time Connected',\n          align: 'start',\n          sortable: true,\n          value: 'lastActive',\n        },\n      ],\n      headersConnectedUsers: [\n        {\n          text: 'Account Number',\n          align: 'start',\n          sortable: true,\n          value: 'accountNumber',\n        },\n        {\n          text: 'Package',\n          align: 'start',\n          sortable: true,\n          value: 'package',\n        },\n        {\n          text: 'MAC Address',\n          align: 'start',\n          sortable: true,\n          value: 'macAddress',\n        },\n        {\n          text: 'Device',\n          align: 'start',\n          sortable: true,\n          value: 'device',\n        },\n        {\n          text: 'IP Address',\n          align: 'start',\n          sortable: true,\n          value: 'ipAddress',\n        },\n        {\n          text: 'Connection Time',\n          align: 'start',\n          sortable: true,\n          value: 'connectionTime',\n        },\n        {\n          text: 'Bandwidth Consumption',\n          align: 'start',\n          sortable: true,\n          value: 'bandwidthConsumption',\n        },\n      ],\n      connectedUsersPerAP: 0,\n      connectedUsersPerAPMap: {},\n      connectedUsers: [],\n      allConnectedUsersData: [],\n      currentConnectedAPs: [],\n      accessPointOptions: [],\n      selectedAccessPoint: null,\n      loading: false,\n    };\n  },\n  async created() {\n    await this.fetchData();\n  },\n  methods: {\n    async fetchData() {\n      try {\n        this.loading = true;\n\n        // Fetch all data in parallel\n        const [\n          countConnectedUsersResponse,\n          countConnectedAPsResponse,\n          totalUserConnectionsTodayResponse,\n          totalBandwidthConsumptionTodayResponse,\n          avgConnectionTimeResponse,\n          avgBandwidthConnectionResponse,\n          countConnectedUsersPerApResponse,\n          connectedUsersPerApResponse,\n          currentConnectedAPs,\n        ] = await Promise.all([\n          ApiService.getCountConnectedUsers(),\n          ApiService.getCountCurrentConnectedAPs(),\n          ApiService.getTotalUserConnectionsToday(),\n          ApiService.getTotalBandwidthConsumptionToday(),\n          ApiService.getAvgConnectionTime(),\n          ApiService.getAverageBandwidthPerConnection(),\n          ApiService.getCountCurrentlyConnectedUsersPerAP(),\n          ApiService.getCurrentConnectedUsersPerAP(),\n          ApiService.getCurrentConnectedAPs(),\n        ]);\n\n        // Update overall summary cards\n        this.cardsOverallSummary[0].value = countConnectedUsersResponse.data.connectedUsers;\n        this.cardsOverallSummary[1].value = countConnectedAPsResponse.data.connectedAPs;\n        this.cardsOverallSummary[2].value = totalUserConnectionsTodayResponse.data.totalUserConnectionsToday;\n        this.cardsOverallSummary[3].value = totalBandwidthConsumptionTodayResponse.data.totalBandwidthConsumptionToday;\n        this.cardsOverallSummary[4].value = avgConnectionTimeResponse.data.averageConnectionTime;\n        this.cardsOverallSummary[5].value = avgBandwidthConnectionResponse.data.averageBandwidthPerConnection;\n\n        // Convert array to map\n        this.connectedUsersPerAPMap = {};\n        countConnectedUsersPerApResponse.data.forEach((item) => {\n          this.connectedUsersPerAPMap[item.apMacAddress] = item.userCount;\n        });\n\n        // Store all connected users data\n        this.allConnectedUsersData = connectedUsersPerApResponse.data;\n\n        // Setup options for the select field\n        this.currentConnectedAPs = currentConnectedAPs.data.data;\n        this.accessPointOptions = this.currentConnectedAPs.map((ap) => ({\n          text: ap,\n          value: ap,\n        }));\n\n        // Optionally pre-select the first access point\n        if (this.accessPointOptions.length > 0) {\n          this.selectedAccessPoint = this.accessPointOptions[0].value;\n          this.connectedUsersPerAP = this.connectedUsersPerAPMap[this.selectedAccessPoint] || 0;\n          this.cardsAP[0].value = this.connectedUsersPerAP;\n          this.loadUsersForSelectedAP();\n        }\n      } catch (error) {\n        console.error('Error fetching data: ', error);\n      } finally {\n        this.loading = false;\n      }\n    },\n    onAPChange(selectedAccessPoint) {\n      this.selectedAccessPoint = selectedAccessPoint;\n      this.loadUsersForSelectedAP();\n    },\n    loadUsersForSelectedAP() {\n      if (!this.selectedAccessPoint) return;\n      // Update the count of connected users\n      this.connectedUsersPerAP = this.connectedUsersPerAPMap[this.selectedAccessPoint] || 0;\n      // Update the card value\n      this.cardsAP[0].value = this.connectedUsersPerAP;\n      // Find the AP data in allConnectedUsersData\n      const apData = this.allConnectedUsersData.find(\n        (ap) => ap.apMacAddress === this.selectedAccessPoint,\n      );\n      // Update the connected users table data\n      this.connectedUsers = apData ? apData.connectedUsers : [];\n    },\n    formatCardValue(card) {\n      if (card.title === 'Total Bandwidth Consumption for Today' || card.title === 'Average Bandwidth Per Connection') {\n        return `${card.value} MB`;\n      }\n      if (card.title === 'Average Connection Time') {\n        return `${card.value} MINS`;\n      }\n      return card.value;\n    },\n  },\n};\n</script>\n\n<style scoped>\n/* Prevent header text wrapping and center vertically */\n.header-nowrap >>> th {\n  white-space: nowrap;\n  vertical-align: middle !important;\n}\n\n/* Ensure table cells don't wrap either */\n.header-nowrap >>> td {\n  white-space: nowrap;\n}\n\n/* Optional: Add some padding to headers for better appearance */\n.header-nowrap >>> th {\n  padding: 0 16px !important;\n}\n</style>"]}]}